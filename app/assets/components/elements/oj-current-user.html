<dom-module id="oj-current-user">
  <template>

    <json-request method="get" auto="true" url="/api/user" on-success="isReady"></json-request>

  </template>
  <script>
    Polymer({
      is: 'oj-current-user',
      isReady: function (event) {
        var user;
        if (event.detail.response && event.detail.response.name) {
          user = event.detail.response;
          window.current_user = user;
          this.fire('user-logged-in', user); //mro todo asyncFire
        } else {
          user = null;
          this.fire('user-logged-out'); //mRo todo asyncFire
        }
        this.fire('user', user); //mRo todo asyncFire
      }
    });
  </script>
</dom-module>
